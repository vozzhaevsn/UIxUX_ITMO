const t=new Map;function e(t){if(t.startsWith("#"))return function(t){t=t.replace("#","");const e=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),r=parseInt(t.substring(4,6),16);return{r:e,g:n,b:r}}(t);if(t.startsWith("rgb")){const[e,n,r]=t.match(/\d+/g).map(Number);return{r:e,g:n,b:r}}return{r:0,g:0,b:0}}function n(t,e,n){const r=[t,e,n].map(t=>(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4));return.2126*r[0]+.7152*r[1]+.0722*r[2]}let r=new WeakMap;async function o(){const t=performance.now(),e=function(){const t="p, h1, h2, h3, h4, h5, h6, span, a, li, td, button, label";return Array.from(document.querySelectorAll(t)).filter(t=>t.textContent.trim().length>0&&function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}(t))}(),n={url:location.href,timestamp:(new Date).toISOString(),elements:[],errors:[]};for(const r of e.slice(0,1e3)){if(performance.now()-t>500)break;const e=await s(r);e&&(n.elements.push(e),"ERROR"===e.status&&n.errors.push(e))}return sessionStorage.setItem("lastScan",JSON.stringify(n)),n}async function s(o){if(r.has(o))return r.get(o);const s=getComputedStyle(o),u=e(s.color),f=e(function(t){for(;t;){const e=getComputedStyle(t).backgroundColor;if("rgba(0, 0, 0, 0)"!==e)return e;t=t.parentElement}return"#ffffff"}(o)),c=function(e,r){const o=`${JSON.stringify(e)}_${JSON.stringify(r)}`;if(t.has(o))return t.get(o);const s=n(...Object.values(e))+.05,a=n(...Object.values(r))+.05,i=Math.max(s,a)/Math.min(s,a);return t.set(o,i),i}(u,f),l=parseFloat(s.fontSize),g=l>=18||"bold"===s.fontWeight&&l>=14?3:4.5,m={element:o.tagName,selector:a(o),textColor:`rgb(${u.r},${u.g},${u.b})`,bgColor:`rgb(${f.r},${f.g},${f.b})`,contrast:parseFloat(c.toFixed(2)),required:g,fontSize:`${l}px`,status:c>=g?"OK":"ERROR",suggestion:c>=g?"":i(u,f)};return r.set(o,m),m}function a(t){const e=[];for(;t;){let n=t.tagName.toLowerCase();if(t.id){n+=`#${t.id}`,e.unshift(n);break}{let e=t,r=1;for(;e=e.previousElementSibling;)e.tagName===t.tagName&&r++;1!==r&&(n+=`:nth-of-type(${r})`)}e.unshift(n),t=t.parentElement}return e.join(" > ")}function i(t,e){return"Измените цвет текста на "+(.05+4.5*n(...Object.values(e))>.5?"темнее":"светлее")}export{o as scanPage};
//# sourceMappingURL=contrast-bundle.js.map
